<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N√¢ng C·∫•p T√†i Kho·∫£n - NexusTools</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="muakey.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="100" cy="100" r="95" fill="url(#bgGradient)" stroke="url(#borderGradient)" stroke-width="4"/>
                    <g id="nodes">
                        <circle cx="80" cy="40" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="120" cy="35" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="160" cy="50" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="40" cy="80" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="35" cy="120" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="160" cy="120" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="165" cy="160" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="80" cy="165" r="8" fill="url(#nodeGradient)"/>
                        <circle cx="120" cy="160" r="8" fill="url(#nodeGradient)"/>
                    </g>
                    <g id="connections" stroke="url(#lineGradient)" stroke-width="6" fill="none">
                        <line x1="80" y1="40" x2="100" y2="100"/>
                        <line x1="120" y1="35" x2="100" y2="100"/>
                        <line x1="160" y1="50" x2="100" y2="100"/>
                        <line x1="40" y1="80" x2="100" y2="100"/>
                        <line x1="35" y1="120" x2="100" y2="100"/>
                        <line x1="160" y1="120" x2="100" y2="100"/>
                        <line x1="165" y1="160" x2="100" y2="100"/>
                        <line x1="80" y1="165" x2="100" y2="100"/>
                        <line x1="120" y1="160" x2="100" y2="100"/>
                    </g>
                    <circle cx="100" cy="100" r="25" fill="url(#hubGradient)" stroke="url(#hubBorder)" stroke-width="4"/>
                    <g id="toolIcon" transform="translate(85, 85)">
                        <path d="M5 5L25 25M25 5L5 25M15 0V30M0 15H30" stroke="white" stroke-width="3" stroke-linecap="round"/>
                    </g>
                    <defs>
                        <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#0f172a;stop-opacity:0.9"/>
                            <stop offset="100%" style="stop-color:#1e293b;stop-opacity:0.9"/>
                        </linearGradient>
                        <linearGradient id="borderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1"/>
                            <stop offset="50%" style="stop-color:#8b5cf6;stop-opacity:1"/>
                            <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1"/>
                        </linearGradient>
                        <radialGradient id="nodeGradient" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#10b981;stop-opacity:1"/>
                            <stop offset="100%" style="stop-color:#059669;stop-opacity:1"/>
                        </radialGradient>
                        <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.8"/>
                            <stop offset="100%" style="stop-color:#06b6d4;stop-opacity:0.8"/>
                        </linearGradient>
                        <radialGradient id="hubGradient" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1"/>
                            <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1"/>
                        </radialGradient>
                        <linearGradient id="hubBorder" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1"/>
                            <stop offset="100%" style="stop-color:#ec4899;stop-opacity:1"/>
                        </linearGradient>
                    </defs>
                </svg>
                <span class="logo-text">NexusTools</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 5H17M3 10H17M3 15H17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        
        <nav class="sidebar-nav">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link" data-page="home">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M3 7L10 2L17 7V17C17 17.5304 16.7893 18.0391 16.4142 18.4142C16.0391 18.7893 15.5304 19 15 19H5C4.46957 19 3.96086 18.7893 3.58579 18.4142C3.21071 18.0391 3 17.5304 3 17V7Z" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M8 19V11H12V19" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <span class="nav-text">Trang ch·ªß</span>
                    </a>
                </li>
                
                <li class="nav-item active">
                    <a href="muakey.html" class="nav-link" data-page="buykey">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"/>
                            <path d="M15 9L9 15M9 9L15 15"/>
                        </svg>
                        <span class="nav-text">N√¢ng C·∫•p VIP</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="chinhanhthe.html" class="nav-link" data-page="text">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M8 6H16M8 12H16M8 18H14M4 4H20C21.1046 4 22 4.89543 22 6V18C22 19.1046 21.1046 20 20 20H4C2.89543 20 2 19.1046 2 18V6C2 4.89543 2.89543 4 4 4Z" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <span class="nav-text">·∫¢NH TH·∫∫ MASTER</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="promt.html" class="nav-link" data-page="image">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <rect x="3" y="5" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                            <circle cx="7.5" cy="9.5" r="1.5" fill="currentColor"/>
                            <path d="M14 13L10 9L5 14" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <span class="nav-text">PROMPT CH·ªàNH ·∫¢NH AI</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="admin.html" class="nav-link" data-page="admin">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                             <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" />
                        </svg>
                        <span class="nav-text">Admin Profile</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10 2V4M10 16V18M4 10H2M6.31412 6.31412L4.8999 4.8999M15.6859 6.31412L17.1001 4.8999M6.31412 13.6859L4.8999 15.1001M15.6859 13.6859L17.1001 15.1001M18 10H16M14 10C14 12.2091 12.2091 14 10 14C7.79086 14 6 12.2091 6 10C6 7.79086 7.79086 6 10 6C12.2091 6 14 7.79086 14 10Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span class="nav-text">Ch·∫ø ƒë·ªô t·ªëi</span>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <div class="container">
            <header class="page-header">
                <h1>üíé N√¢ng C·∫•p T√†i Kho·∫£n</h1>
                <p>M·ªü kh√≥a to√†n b·ªô t√≠nh nƒÉng v√† c√¥ng c·ª• cao c·∫•p</p>
            </header>

            <!-- Status Section -->
            <div class="status-card" id="statusCard">
                <div class="status-info">
                    <h3>Tr·∫°ng th√°i t√†i kho·∫£n: <span id="accountStatus" class="badge basic">Th∆∞·ªùng</span></h3>
                    <p id="expiryDate" style="display: none;">H·∫øt h·∫°n: --/--/----</p>
                </div>
                <div class="activation-box">
                    <input type="text" id="keyInput" placeholder="Nh·∫≠p m√£ k√≠ch ho·∫°t (Key)..." class="key-input">
                    <button id="activateBtn" class="activate-btn">K√≠ch Ho·∫°t Ngay</button>
                </div>
            </div>

            <!-- Pricing Cards -->
            <div class="pricing-grid">
                <!-- Basic Plan -->
                <div class="pricing-card">
                    <div class="card-header">
                        <h3>Mi·ªÖn Ph√≠</h3>
                        <div class="price">0ƒë<span>/vƒ©nh vi·ªÖn</span></div>
                    </div>
                    <ul class="features-list">
                        <li>‚úÖ Truy c·∫≠p c√¥ng c·ª• c∆° b·∫£n</li>
                        <li>‚úÖ Ch·ªânh s·ª≠a ·∫£nh th·∫ª (C√≥ watermark)</li>
                        <li>‚úÖ T·ªëc ƒë·ªô t·∫£i trung b√¨nh</li>
                        <li>‚ùå Xu·∫•t ·∫£nh ch·∫•t l∆∞·ª£ng cao</li>
                        <li>‚ùå H·ªó tr·ª£ ∆∞u ti√™n</li>
                    </ul>
                    <button class="plan-btn outline" disabled>ƒêang s·ª≠ d·ª•ng</button>
                </div>

                <!-- Pro Plan -->
                <div class="pricing-card">
                    <div class="card-header">
                        <h3>G√≥i Pro</h3>
                        <div class="price">99k<span>/th√°ng</span></div>
                    </div>
                    <ul class="features-list">
                        <li>‚úÖ M·ªü kh√≥a T·∫§T C·∫¢ t√≠nh nƒÉng</li>
                        <li>‚úÖ Xu·∫•t ·∫£nh ch·∫•t l∆∞·ª£ng cao 4K</li>
                        <li>‚úÖ Kh√¥ng c√≥ logo (Watermark)</li>
                        <li>‚úÖ T·∫£i xu·ªëng kh√¥ng gi·ªõi h·∫°n</li>
                        <li>‚úÖ H·ªó tr·ª£ ∆∞u ti√™n 24/7</li>
                    </ul>
                    <a href="payment.html?plan=pro&price=99000" class="plan-btn solid">Mua Ngay</a>
                </div>

                <!-- Premium Plan -->
                <div class="pricing-card featured">
                    <div class="tag">Ph·ªï bi·∫øn nh·∫•t</div>
                    <div class="card-header">
                        <h3>Vƒ©nh Vi·ªÖn</h3>
                        <div class="price">299k<span>/tr·ªçn ƒë·ªùi</span></div>
                    </div>
                    <ul class="features-list">
                        <li>‚úÖ <strong>T·∫•t c·∫£ t√≠nh nƒÉng Pro</strong></li>
                        <li>‚úÖ Thanh to√°n 1 l·∫ßn d√πng m√£i m√£i</li>
                        <li>‚úÖ C·∫≠p nh·∫≠t t√≠nh nƒÉng m·ªõi mi·ªÖn ph√≠</li>
                        <li>‚úÖ Kho t√†i nguy√™n Premium</li>
                        <li>‚úÖ Huy hi·ªáu VIP tr√™n h·ªì s∆°</li>
                    </ul>
                    <a href="payment.html?plan=premium&price=299000" class="plan-btn solid">Mua Ngay</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Custom Payment Modal & Logic -->
    <div id="paymentOverlay" class="payment-overlay">
        <div class="payment-modal">
            <button class="close-btn" onclick="closePaymentModal()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"></path>
                </svg>
            </button>
            
            <div id="paymentStep" class="modal-step">
                <div class="modal-header">
                    <h2>üí≥ Thanh To√°n ƒê∆°n H√†ng</h2>
                    <p class="plan-info">G√≥i: <span id="modalPlanName" class="highlight-text">Pro Plan</span></p>
                    <p class="amount-info">S·ªë ti·ªÅn: <span id="modalPrice" class="highlight-price">99.000ƒë</span></p>
                </div>

                <div class="qr-placeholder">
                    <div class="qr-box">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=ExamplePayment" alt="QR Code">
                        <p>Qu√©t m√£ ƒë·ªÉ thanh to√°n</p>
                    </div>
                    <div class="bank-details">
                        <div class="detail-row">
                            <span>Ng√¢n h√†ng:</span>
                            <strong>MB Bank</strong>
                        </div>
                        <div class="detail-row">
                            <span>S·ªë t√†i kho·∫£n:</span>
                            <strong>0123456789</strong>
                        </div>
                        <div class="detail-row">
                            <span>Ch·ªß t√†i kho·∫£n:</span>
                            <strong>NGUYEN VAN A</strong>
                        </div>
                        <div class="detail-row">
                            <span>N·ªôi dung:</span>
                            <strong class="copy-text">NEXUS MUA KEY</strong>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="confirmBtn" class="action-btn confirm">X√°c nh·∫≠n ƒë√£ chuy·ªÉn kho·∫£n</button>
                </div>
            </div>

            <!-- Beautiful Key Display Step -->
            <div id="keyStep" class="modal-step" style="display: none;">
                <div class="success-content">
                    <div class="success-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <h2>Thanh To√°n Th√†nh C√¥ng!</h2>
                    <p>C·∫£m ∆°n b·∫°n ƒë√£ n√¢ng c·∫•p. ƒê√¢y l√† m√£ k√≠ch ho·∫°t c·ªßa b·∫°n:</p>
                    
                    <div class="key-container">
                        <div class="key-label">LICENSE KEY</div>
                        <div class="key-value" id="finalKey">NEXUS-VIP-8888-9999</div>
                        <button class="copy-key-btn" onclick="copyKey()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            Sao ch√©p
                        </button>
                    </div>
                    
                    <p class="note">Vui l√≤ng l∆∞u l·∫°i m√£ n√†y. M√£ ch·ªâ hi·ªÉn th·ªã m·ªôt l·∫ßn!</p>
                    <button class="action-btn close-final" onclick="closePaymentModal()">Ho√†n t·∫•t</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Toast Notification -->
    <div id="toastContainer" class="toast-container"></div>

    <style>
        /* Modal Styles */
        .payment-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .payment-overlay.active {
            display: flex;
            opacity: 1;
        }

        .payment-modal {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 24px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .payment-overlay.active .payment-modal {
            transform: scale(1);
        }

        .close-btn {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: transparent;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #fff, #94a3b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .highlight-text {
            color: #6366f1;
            font-weight: 600;
        }

        .highlight-price {
            color: #10b981;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .qr-placeholder {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .qr-box {
            text-align: center;
        }

        .qr-box img {
            border-radius: 8px;
            border: 2px solid #fff;
        }

        .qr-box p {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-top: 0.5rem;
        }

        .bank-details {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #cbd5e1;
            border-bottom: 1px dashed rgba(255,255,255,0.1);
            padding-bottom: 4px;
        }

        .action-btn {
            width: 100%;
            padding: 1rem;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn.confirm {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .action-btn.confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        /* Beautiful Key Styles */
        .success-content {
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: #10b981;
            animation: pulse 2s infinite;
        }

        .success-icon svg {
            width: 40px;
            height: 40px;
        }

        .key-container {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .key-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #6366f1, #ec4899);
        }

        .key-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        .key-value {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
            margin-bottom: 1rem;
            letter-spacing: 1px;
            word-break: break-all;
        }

        .copy-key-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .copy-key-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .action-btn.close-final {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            margin-top: 1rem;
        }

        /* Toast Styles */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
        }

        .toast {
            background: rgba(15, 23, 42, 0.95);
            border-left: 4px solid;
            color: #fff;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease;
            backdrop-filter: blur(4px);
            min-width: 300px;
        }

        .toast.error { border-color: #ef4444; }
        .toast.warning { border-color: #f59e0b; }
        .toast.success { border-color: #10b981; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
    </style>

    <script>
        // Modal Logic
        let confirmClickCount = 0;
        let currentPlanType = ''; // 'pro' or 'premium'
        const modal = document.getElementById('paymentOverlay');
        const confirmBtn = document.getElementById('confirmBtn');
        const recheckBtn = document.getElementById('recheckBtn');

        function openPaymentModal(planName, price) {
            document.getElementById('modalPlanName').textContent = planName;
            document.getElementById('modalPrice').textContent = price;
            
            // Determine plan type from name
            if (planName.includes('Pro')) {
                currentPlanType = 'pro';
            } else {
                currentPlanType = 'premium';
            }

            // Reset state
            confirmClickCount = 0;
            document.getElementById('paymentStep').style.display = 'block';
            document.getElementById('warningStep').style.display = 'none';
            document.getElementById('keyStep').style.display = 'none';
            
            confirmBtn.textContent = 'X√°c nh·∫≠n ƒë√£ chuy·ªÉn kho·∫£n';
            confirmBtn.disabled = false;
            
            modal.classList.add('active');
        }

        function closePaymentModal() {
            modal.classList.remove('active');
        }

        // Close when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closePaymentModal();
        });

        // 3-Click Logic (Modified)
        function handleConfirmLogic() {
            confirmClickCount++;
            
            if (confirmClickCount === 1) {
                // First click: Show warning page
                document.getElementById('paymentStep').style.display = 'none';
                document.getElementById('warningStep').style.display = 'block';
            } 
            else if (confirmClickCount === 2) {
                // Second click: Still show warning page (blink effect)
                const warningContent = document.querySelector('.warning-content');
                warningContent.style.animation = 'none';
                warningContent.offsetHeight; /* trigger reflow */
                warningContent.style.animation = 'shake 0.5s';
                
                // Optional: Update text slightly or just keep it same as requested
                // "V·∫´n b√°o c√¢u nh∆∞ v·∫≠y" -> Keep same text
            } 
            else if (confirmClickCount === 3) {
                // Third click: Success!
                document.getElementById('warningStep').style.display = 'none';
                document.getElementById('keyStep').style.display = 'block';
                
                // Generate Key based on Plan Type
                let prefix = 'NEXUS-VIP-'; // Default
                if (currentPlanType === 'pro') {
                    prefix = 'NEXUS-PRO-';
                }
                
                const randomPart1 = Math.random().toString(36).substr(2, 4).toUpperCase();
                const randomPart2 = Math.random().toString(36).substr(2, 4).toUpperCase();
                const randomKey = `${prefix}${randomPart1}-${randomPart2}`;
                
                document.getElementById('finalKey').textContent = randomKey;
                showToast('‚úÖ X√°c nh·∫≠n th√†nh c√¥ng!', 'success');
            }
        }

        // Attach listeners
        confirmBtn.addEventListener('click', handleConfirmLogic);
        recheckBtn.addEventListener('click', handleConfirmLogic);

        // Toast Notification System
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = '';
            if (type === 'error') icon = '‚õî';
            if (type === 'warning') icon = '‚è≥';
            if (type === 'success') icon = 'üéâ';

            toast.innerHTML = `<span>${icon}</span><span>${message}</span>`;
            
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s reverse forwards';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function copyKey() {
            const keyText = document.getElementById('finalKey').textContent;
            navigator.clipboard.writeText(keyText).then(() => {
                showToast('ƒê√£ sao ch√©p m√£ Key!', 'success');
                const btn = document.querySelector('.copy-key-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = 'ƒê√£ ch√©p!';
                setTimeout(() => btn.innerHTML = originalText, 2000);
            });
        }
        
        // Add shake animation style dynamically
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            @keyframes shake {
                0% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                50% { transform: translateX(10px); }
                75% { transform: translateX(-10px); }
                100% { transform: translateX(0); }
            }
        `;
        document.head.appendChild(styleSheet);
    </script>

    <!-- Restore original scripts -->
    <script src="script.js"></script>
    <script src="muakey.js"></script>
    <script src="auth.js"></script>
</body>
</html>